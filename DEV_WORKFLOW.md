# Docusaurus Workflow (Desktop + Laptop)

This is the current workflow for working on `human-behavior-site` from multiple devices.

Publishing is now handled automatically by GitHub Actions when you push to `main`.

## One-Time Setup (per device)

Do this once on each computer:

```bash
cd ~/Projects
git clone https://github.com/doesburg11/human-behavior-site.git
cd human-behavior-site
npm install
```

Notes:
- `npm install` is fine for first setup.
- Prefer `npm ci` in CI (GitHub Actions already does this).

## One-Time Setup (repository, already done)

This repo has a GitHub Actions deploy workflow:
- `.github/workflows/deploy-to-pages-repo.yml`

It requires a repository secret in `doesburg11/human-behavior-site`:
- `DEPLOY_REPO_PAT` (PAT with write access to `doesburg11/doesburg11.github.io`)

## Regular Workflow (per session)

```bash
cd ~/Projects/human-behavior-site
git pull
```

If you work on branches, make sure you are on the correct branch before pulling:

```bash
git switch main
git pull
```

## Work on the Site

Common edits:
- Content pages in `docs/`
- Images/assets in `static/`
- Custom React pages/components in `src/`
- Top-level/custom sidebar grouping in `sidebars.js` (most nested sections are now autogenerated)

For many new folders/subfolders in `docs/`, add `_category_.json` for readable sidebar labels.

Local preview:

```bash
npm run start
```

## Publish (Recommended: automatic)

To publish changes:

```bash
git add -A
git commit -m "Describe changes"
git push origin main
```

What happens next:
- Push to `main` triggers GitHub Actions deploy
- GitHub builds Docusaurus
- GitHub pushes generated files to `doesburg11/doesburg11.github.io`
- The live site updates if the workflow succeeds

Check deploy status in GitHub:
- `human-behavior-site` -> `Actions` -> `Deploy Site To Pages Repo`

Important:
- `commit` alone does not publish
- `push` to `main` publishes (via GitHub Actions)

## Manual Deploy (Fallback only)

Use this only if GitHub Actions is unavailable and you need a manual deploy:

```bash
./deploy.sh
```

This script:
- Builds the site
- Syncs `build/` into the Pages repo
- Commits/pushes only when there are actual deploy changes

## Quick Rule of Thumb

- Edit locally
- Preview with `npm run start`
- Commit + push to `main`
- Let GitHub Actions publish

## Troubleshooting

- I committed, but the site did not update:
  - `commit` only saves locally. Run `git push origin main`.

- I pushed, but nothing published:
  - Check `human-behavior-site` -> `Actions` -> `Deploy Site To Pages Repo`.
  - If the workflow failed, open the failed step and read the error lines.

- Workflow says `No deploy changes.`:
  - The build output did not change (normal if your edits do not affect generated files).

- Workflow fails with missing secret / auth error:
  - Verify repository secret `DEPLOY_REPO_PAT` exists in `doesburg11/human-behavior-site`.
  - Verify the PAT has write access to `doesburg11/doesburg11.github.io`.

- Workflow does not start after push:
  - Make sure you pushed to `main` (the deploy workflow only triggers on `main`).

- Local preview works, but build/deploy fails:
  - Run `npm run build` locally to reproduce the error before pushing.
  - Common cause: MDX parsing issues (for example raw `<` or `>` text not wrapped in backticks/code).
